# 🗺️ MrgqPdfViewer 기능 로드맵

## 📋 현재 상태 (v0.1.4)

### ✅ 구현 완료된 기능
- PDF 파일 목록 뷰어 및 정렬
- 고해상도 PDF 렌더링 (단일/두 페이지 모드)
- 웹 서버 기반 파일 업로드 (진행률 표시)
- 설정 화면 (포트, 파일별 설정 관리)
- 리모컨 최적화 탐색 시스템
- 파일 간 네비게이션

---

## 🎯 단기 추가 기능 (v0.1.5~0.1.6)

### 1. 마지막 읽은 위치 기억 📖
**중요도: ⭐⭐⭐⭐⭐**

**구현 방식:**
```kotlin
// SharedPreferences에 파일별 마지막 페이지 저장
private fun saveLastReadPage(fileKey: String, pageNumber: Int) {
    preferences.edit().putInt("last_page_$fileKey", pageNumber).apply()
}

private fun getLastReadPage(fileKey: String): Int {
    return preferences.getInt("last_page_$fileKey", 0)
}
```

**기능 세부사항:**
- 파일을 다시 열면 마지막 읽은 페이지로 자동 이동
- 설정에서 "마지막 위치 기억" ON/OFF 토글
- 파일 목록에서 읽은 진행률 표시 (예: "3/10 페이지")
- 첫 페이지에서는 기능 비활성화

### 2. 북마크 시스템 🔖
**중요도: ⭐⭐⭐⭐**

**데이터 구조:**
```kotlin
data class Bookmark(
    val id: String,
    val fileKey: String,
    val fileName: String,
    val pageNumber: Int,
    val note: String = "",
    val createdAt: Long = System.currentTimeMillis()
)
```

**기능 세부사항:**
- MENU 키로 현재 페이지 북마크 추가/제거
- 설정 화면에서 북마크 목록 관리
- 북마크된 페이지에 시각적 표시 (⭐ 아이콘)
- 북마크 클릭 시 해당 페이지로 바로 이동

### 3. 파일 썸네일 미리보기 🖼️
**중요도: ⭐⭐⭐⭐**

**구현 방식:**
```kotlin
class ThumbnailCache {
    private val cache = LruCache<String, Bitmap>(50)
    
    suspend fun getThumbnail(filePath: String): Bitmap? {
        return cache.get(filePath) ?: generateThumbnail(filePath)
    }
}
```

**기능 세부사항:**
- 파일 목록에서 첫 페이지 썸네일 표시
- 백그라운드에서 비동기로 썸네일 생성
- LRU 캐시로 메모리 효율성 확보
- 썸네일 생성 실패 시 기본 PDF 아이콘 표시

### 4. 줌 기능 🔍
**중요도: ⭐⭐⭐**

**조작 방식:**
- DPAD CENTER 길게 눌러서 줌 모드 진입
- UP/DOWN으로 줌 인/아웃 (1.0x ~ 4.0x)
- 줌 상태에서 LEFT/RIGHT/UP/DOWN으로 팬
- BACK 키로 줌 모드 종료

---

## 🚀 중기 추가 기능 (v0.2.0)

### 5. 자동 페이지 넘김 ⏱️
**중요도: ⭐⭐⭐**

**설정 옵션:**
- 자동 넘김 시간: 10초, 30초, 1분, 2분, 5분
- 음악 연주 시간에 맞춘 커스텀 시간
- 자동 넘김 중 일시정지/재생 (ENTER 키)
- 마지막 페이지에서 자동 정지

### 6. 메타데이터 관리 🎵
**중요도: ⭐⭐⭐**

**메타데이터 구조:**
```json
{
  "title": "캐논 변주곡",
  "composer": "파헬벨",
  "tempo": "Andante",
  "key": "D Major",
  "genre": "바로크",
  "difficulty": "중급",
  "duration": "4분 30초",
  "tags": ["클래식", "바로크", "웨딩"],
  "notes": "연주 주의사항..."
}
```

**기능:**
- 파일별 곡 정보 입력/편집 (웹 인터페이스)
- 작곡가, 장르별 필터링 및 검색
- 연주 시간 기록 및 통계
- 메타데이터 기반 자동 정렬

### 7. 플레이리스트 시스템 📝
**중요도: ⭐⭐⭐**

**기능:**
- 연주회용 곡 순서 구성
- 드래그 앤 드롭으로 순서 변경
- 플레이리스트별 자동 진행
- 곡 간 전환 시간 설정
- 플레이리스트 내보내기/가져오기

### 8. 파일 관리 강화 📁
**중요도: ⭐⭐**

**기능:**
- 폴더 구조 지원 (composer/genre별 분류)
- 파일 이름 변경 (웹 인터페이스)
- 즐겨찾기 표시 및 필터링
- 파일 복사/이동 기능

---

## 🔮 고급 기능 (v0.3.0+)

### 9. 음성/제스처 인식 🎙️
**중요도: ⭐⭐**

**음성 명령:**
- "다음 페이지", "이전 페이지"
- "북마크 추가", "북마크 제거"
- "자동 넘김 시작/정지"

**제스처 인식:**
- 박수 소리 감지로 페이지 넘김
- 손 흔들기 제스처 감지 (카메라 사용)

### 10. 연습 도구 🎹
**중요도: ⭐⭐**

**기능:**
- 내장 메트로놈 (BPM 조절)
- 구간 반복 연습 (A-B 포인트 설정)
- 연습 시간 기록 및 통계
- 연습 일지 작성

### 11. 클라우드 동기화 ☁️
**중요도: ⭐⭐**

**지원 서비스:**
- Google Drive, Dropbox 연동
- 여러 기기 간 설정/북마크 동기화
- 온라인 악보 라이브러리 접근
- 자동 백업 기능

### 12. 협업 기능 👥
**중요도: ⭐⭐⭐⭐⭐** ⚡ **우선 구현 대상**

**마스터/슬레이브 모드:**
```kotlin
// 마스터 기기에서 페이지 변경 브로드캐스트
class PageSyncManager {
    fun broadcastPageChange(pageNumber: Int) {
        val message = "{\"action\":\"page_change\",\"page\":$pageNumber}"
        broadcastToClients(message)
    }
}
```

**핵심 기능:**
- 여러 기기 간 실시간 페이지 동기화
- 앙상블/합주용 다중 기기 연동
- 마스터 기기에서 모든 슬레이브 기기 제어
- QR 코드로 간편한 기기 연결
- Wi-Fi Direct 또는 같은 네트워크 기반 연결

**사용 시나리오:**
- 지휘자와 연주자 간 페이지 동기화
- 듀오/트리오 연주 시 파트별 악보 동기화
- 학생-선생님 간 레슨용 동기화

---

## 💡 즉시 구현 가능한 간단한 기능들

### A. UI 개선
- 다크/라이트 테마 토글
- 페이지 정보 표시 스타일 선택 (위치, 크기, 투명도)
- 키 매핑 커스터마이징
- 파일 목록 표시 모드 (리스트/그리드)

### B. 편의 기능
- 파일 검색 기능 (파일명 기반)
- 최근 열어본 파일 목록 (5~10개)
- 파일 정렬 옵션 추가 (크기순, 추가일순)
- 파일 정보 상세 보기 (페이지 수, 생성일, 크기)

### C. 웹 인터페이스 개선
- 모바일 최적화 웹 UI
- QR 코드로 웹 주소 공유
- 웹에서 북마크 관리
- 메타데이터 편집 인터페이스

---

## 🎯 우선 구현 계획

### Phase 1: 협업 기능 구현 (v0.1.5) ⚡
**목표**: 앙상블/합주용 다중 기기 페이지 동기화

**구현 단계:**
1. **네트워크 통신 기반 구축**
   - WebSocket 서버/클라이언트 구현
   - 기기 간 연결 관리 시스템

2. **마스터/슬레이브 모드 구현**
   - 마스터 기기 선정 및 권한 관리
   - 슬레이브 기기 자동 페이지 동기화

3. **연결 관리 UI**
   - 설정에서 협업 모드 ON/OFF
   - 연결된 기기 목록 표시
   - QR 코드 기반 간편 연결

4. **동기화 로직**
   - 페이지 변경 시 실시간 브로드캐스트
   - 네트워크 끊김 시 재연결 로직
   - 충돌 해결 (마스터 우선)

### Phase 2: 핵심 편의 기능 (v0.1.6)
- 마지막 읽은 위치 기억
- 파일 썸네일 미리보기
- 북마크 시스템

### Phase 3: 고급 기능 (v0.2.0)
- 메타데이터 관리
- 플레이리스트 시스템
- 자동 페이지 넘김

---

## 📊 기능별 구현 난이도

| 기능 | 난이도 | 예상 개발 시간 | 우선순위 |
|------|--------|----------------|----------|
| 협업 기능 | 🔴 상 | 3-4일 | ⚡ 최우선 |
| 마지막 위치 기억 | 🟢 하 | 0.5일 | 높음 |
| 북마크 시스템 | 🟡 중 | 1-2일 | 높음 |
| 썸네일 미리보기 | 🟡 중 | 1-2일 | 높음 |
| 줌 기능 | 🟡 중 | 1-2일 | 중간 |
| 메타데이터 관리 | 🔴 상 | 2-3일 | 중간 |
| 음성 인식 | 🔴 상 | 4-5일 | 낮음 |

---

## 🎵 협업 기능 상세 설계

### 네트워크 아키텍처
```
마스터 기기 (지휘자/리더)
    ↓ (WebSocket 브로드캐스트)
┌─────────────────────────────┐
│  슬레이브1   슬레이브2   슬레이브3  │
│ (바이올린)  (비올라)   (첼로)    │
└─────────────────────────────┘
```

### 메시지 프로토콜
```json
{
  "action": "page_change",
  "page": 5,
  "timestamp": 1699123456789,
  "master_id": "device_12345"
}

{
  "action": "sync_request",
  "device_id": "device_67890",
  "device_name": "바이올린_악보대"
}
```

### 사용자 시나리오
1. **연결 설정**: 마스터 기기에서 QR 코드 생성
2. **슬레이브 연결**: QR 스캔으로 자동 연결
3. **동기화 시작**: 마스터에서 페이지 이동 시 모든 기기 동기화
4. **오프라인 처리**: 연결 끊김 시 개별 동작, 재연결 시 자동 동기화

이 로드맵을 기반으로 협업 기능부터 구현을 시작하시겠습니까?