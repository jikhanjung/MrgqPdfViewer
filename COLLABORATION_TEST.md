# 🎵 협업 기능 테스트 가이드

## 📱 테스트 준비

### 필요한 환경
- Android TV 기기 2대 이상 (또는 에뮬레이터)
- 같은 Wi-Fi 네트워크에 연결
- MrgqPdfViewer v0.1.5+ 설치
- 동일한 PDF 파일들

### 테스트 시나리오

## 🎯 시나리오 1: 기본 페이지 동기화

### 1. 지휘자 기기 설정
```
1. 앱 실행 → 설정 → 협업 모드
2. "지휘자 모드 (Conductor)" 버튼 클릭
3. 연결 정보 확인: "연결 주소: 192.168.1.XXX:9090"
4. 상태 확인: "협업 모드: 지휘자"
```

### 2. 연주자 기기 설정
```
1. 앱 실행 → 설정 → 협업 모드  
2. "연주자 모드 (Performer)" 버튼 클릭
3. "지휘자 IP" 필드에 지휘자 IP 입력 (예: 192.168.1.100)
4. "연결" 버튼 클릭
5. 상태 확인: "협업 모드: 연주자 (연결됨: 192.168.1.100:9090)"
```

### 3. 동기화 테스트
```
1. 지휘자 기기에서 PDF 파일 열기
2. 연주자 기기에서 동일한 PDF 파일 열기
3. 지휘자가 페이지 이동 (LEFT/RIGHT 키) 
4. 연주자 화면이 자동으로 따라서 이동하는지 확인
```

## 🔍 디버그 로그 확인

### adb logcat 명령어
```bash
# 지휘자 기기 로그
adb logcat | grep "🎵"

# 연주자 기기 로그  
adb logcat | grep "🎼"

# 전체 협업 관련 로그
adb logcat | grep -E "(Collaboration|🎵|🎼)"
```

### 예상되는 로그 메시지

**지휘자 기기:**
```
🎵 지휘자 모드: 새 연주자 연결됨 - Android TV Device
🎵 지휘자 모드: 현재 상태를 새 연주자에게 전송 중...
🎵 지휘자 모드: 페이지 3 브로드캐스트 중...
```

**연주자 기기:**
```
🎼 연주자 모드: 페이지 3 변경 신호 수신됨
🎼 연주자 모드: 페이지 3로 이동 중...
🎼 연주자 모드: 페이지 3로 이동 완료
```

## 🚨 문제 해결

### 연결이 안 될 때
1. **방화벽 확인**: 9090 포트가 열려있는지 확인
2. **네트워크 확인**: 같은 Wi-Fi에 연결되어 있는지 확인
3. **IP 주소 확인**: 지휘자 IP가 정확한지 확인

### 동기화가 안 될 때
1. **파일명 확인**: 지휘자와 연주자가 동일한 파일명인지 확인
2. **연결 상태 확인**: 화면 우상단에 연결 상태 표시 확인
3. **로그 확인**: adb logcat으로 메시지 전송/수신 확인

### 일반적인 오류

**"서버 시작 실패"**
- 포트 9090이 이미 사용 중
- 다른 앱을 종료하거나 기기 재시작

**"연결 실패"**  
- 지휘자 기기의 IP 주소가 틀림
- 지휘자 기기에서 협업 모드가 활성화되지 않음

**"요청된 파일을 찾을 수 없습니다"**
- 연주자 기기에 해당 파일이 없음
- 파일명이 정확히 일치하지 않음

## 🎯 테스트 체크리스트

### 기본 기능
- [ ] 지휘자 모드 활성화
- [ ] 연주자 모드 활성화  
- [ ] IP 주소로 연결
- [ ] 연결 상태 표시
- [ ] 페이지 동기화
- [ ] 파일 변경 동기화

### 고급 기능
- [ ] 여러 연주자 동시 연결 (3-4대)
- [ ] 네트워크 끊김 후 재연결
- [ ] 지휘자 기기 재시작 후 재연결
- [ ] 두 페이지 모드에서 동기화

### 안정성 테스트
- [ ] 30분 이상 연결 유지
- [ ] 100번 이상 페이지 변경
- [ ] 연주자 기기 추가/제거 반복

## 📊 성능 측정

### 응답 시간 측정
```bash
# 지휘자가 페이지 변경한 시간과 연주자가 받은 시간 차이
adb logcat | grep -E "(브로드캐스트|수신됨)" --line-buffered | while read line; do echo "$(date '+%H:%M:%S.%3N') $line"; done
```

### 목표 성능
- **응답 시간**: < 100ms
- **연결 안정성**: > 99%
- **메모리 사용량**: < 50MB 추가

이 테스트를 통해 실제 연주 환경에서 협업 기능이 안정적으로 작동하는지 확인할 수 있습니다! 🎵